<!DOCTYPE HTML>
<html>
	<head>
		<title>EyeCast</title>
		<meta name="viewport" content="initial-scale=1.0, user-scalable=no">
		<meta charset="utf-8">
		<style>
			html, body, #map-canvas {
				height: 100%;
				margin: 0px;
				padding: 0px
			}

			.scrollFix {
				overflow: hidden;
				white-space: nowrap;
			}
		</style>
		<script>
			function initialize() {
				var myLatlng = new google.maps.LatLng(37.563722, 126.93722299999993);
				var initialLocation;
				var mapOptions = {
					zoom : 8,
					center : myLatlng,
					streetViewControl : false
				};

				var map = new google.maps.Map(document.getElementById('map-canvas'), mapOptions);

				if (navigator.geolocation) {
					navigator.geolocation.getCurrentPosition(function(position) {
						// When user allowed to send their location
						initialLocation = new google.maps.LatLng(position.coords.latitude, position.coords.longitude);
						map.setCenter(initialLocation);
						map.setZoom(14);
						
						
						
						var mymarker = new google.maps.Marker({
							position : initialLocation,
							map : map,
							icon : 'eye1.png',
							title : "Your location"
						});
						
					});

				}

			
		
				var pinColor = "FFFFFF";
				var pinImage = new google.maps.MarkerImage("http://chart.apis.google.com/chart?chst=d_map_pin_letter&chld=%E2%80%A2|" + pinColor, new google.maps.Size(21, 34), new google.maps.Point(0, 0), new google.maps.Point(10, 34));

				var marker = new google.maps.Marker({
					position : myLatlng,
						map : map,
						icon : pinImage
					});

				var title = '팀플사고남ㅋㅋ';
				var post_name = '권회민';
				var post_date = '2014-05-23 13:14';

				var content = "";
				var content_title = '<h2>제목 : ' + title + '</h2>';
				var content_test = '<h5 style="color: #6E7D85"> Posted : ' + post_date + '</h5>' + '<h5 style="color: #6E7D85"> 작성자 : ' + post_name + '</h5>';

				var img = '<img src="eagle-face.jpg" width=230px height=130px alt="" />';
						
				var infowindow = new google.maps.InfoWindow({
					content : '<div class="scrollFix"; style="line-height:0.2em;">' + content_title + content_test + '<hr/>' + '</div>' + img + content,
					maxWidth : 240
				});

				google.maps.event.addListener(marker, 'click', function() {
					infowindow.open(map, marker);
				});
			}
			
			function loadScript() {
				var script = document.createElement('script');
				script.type = 'text/javascript';
				script.src = 'https://maps.googleapis.com/maps/api/js?v=3.exp&sensor=false&' + 'callback=initialize';
				document.body.appendChild(script);
				//				var myWindow = getElementsByClassName('gm-style-iw', 'div')[0];
				//				myWindow.style.overflow = 'scroll';

			}

			/*
			 function getElementsByClassName(classname, tag) {
			 if (!tag)
			 tag = "*";
			 var anchs = document.getElementsByTagName(tag);
			 var total_anchs = anchs.length;
			 var regexp = new RegExp('\\b' + classname + '\\b');
			 var class_items = new Array()

			 for (var i = 0; i < total_anchs; i++) {
			 var this_item = anchs[i];
			 if (regexp.test(this_item.className))
			 class_items.push(this_item);
			 }
			 return class_items;
			 }*/

			window.onload = loadScript;
		</script>
	</head>
	<body>
		<div id="map-canvas"></div>
<?php	
		$db = mysqli_connect("mysql7.000webhost.com", "a7229328_eyecast", "qlalf1234", "a7229328_eyecast");
		
		mysqli_query($db, 'set names utf8');
			
		$sql = 'SELECT `title`, `content`, `locationLat`, `locationLng`, `date`, `userId`, `userName` FROM `database` ORDER BY `id` ASC';
		
		trim($sql);
		
		$result = mysqli_query($db, $sql);
	
		$num_rows = mysqli_num_rows($result);
		
		$row = mysqli_fetch_array($result);

		for($row_num = 1; $row_num < 1 + $num_rows; $row_num++)	{
			reset($row);
			print "<p>제목 : " . $row[0] . "</p>";
			print "<p>내용 : " . $row[1] . "</p>";
			print "<p>위도 " . $row_num . ": " . $row[2] . "</p>";
			print "<p>경도 " . $row_num . ": " . $row[3] . "</p>";
			print "<p>날짜 : " . $row[4] . "</p>";
			print "<p>ID : " . $row[5] . "</p>";
			print "<p>이름 : " . $row[6] . "</p>";
			print "<hr>";
			$row = mysqli_fetch_array($result);
	
		}	
?>
	</body>
</html>